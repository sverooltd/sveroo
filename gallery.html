<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fancy Vehicle Gallery</title>

    <!-- Bootstrap (Grid system + utilities) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        /* ================================================
           FANCY GALLERY — MAIN CARD STYLING
        ================================================= */
        
        .fg-card {
            cursor: pointer;
            transition: transform .28s cubic-bezier(.2, .9, .3, 1), box-shadow .28s;
            outline: none;
        }
        
        .fg-card:hover,
        .fg-card:focus {
            transform: translateY(-6px) scale(1.02);
            box-shadow: 0 12px 30px rgba(2, 6, 23, 0.45);
        }
        
        .fg-title {
            font-size: 1rem;
            font-weight: 700;
        }
        
        .fg-sub {
            font-size: .85rem;
        }
        /* ================================================
           LIGHTBOX / MODAL
        ================================================= */
        
        .fg-lightbox {
            position: fixed;
            inset: 0;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 20000;
        }
        
        .fg-lightbox.d-none {
            display: none;
        }
        
        .fg-lightbox .fg-backdrop {
            position: absolute;
            inset: 0;
            background: rgba(3, 6, 12, 0.75);
            backdrop-filter: blur(4px);
        }
        
        .fg-panel {
            position: relative;
            z-index: 2;
            width: 100%;
            max-width: 1100px;
            padding: 18px;
            border-radius: 12px;
            background: #fff;
            box-shadow: 0 20px 60px rgba(2, 6, 23, 0.6);
            /* KEY: keep modal usable on small screens */
            max-height: 95vh;
            overflow-y: auto;
        }
        
        .fg-close {
            position: absolute;
            right: 10px;
            top: 10px;
            width: 38px;
            height: 38px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }
        /* ================================================
           MAIN IMAGE DISPLAY
        ================================================= */
        
        .fg-main-wrap {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .fg-main-media {
            position: relative;
            overflow: hidden;
            min-height: 220px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            background: #111;
        }
        
        .fg-main-img {
            max-width: 100%;
            max-height: 50vh;
            /* important for tall content */
            transition: transform .6s cubic-bezier(.2, .9, .3, 1), filter .5s;
            transform-origin: center;
        }
        
        .fg-anim-overlay {
            position: absolute;
            inset: 0;
            pointer-events: none;
        }
        /* ================================================
           THUMBNAILS
        ================================================= */
        
        .fg-thumbs {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 6px;
        }
        
        .fg-thumbs img {
            width: 92px;
            height: 64px;
            object-fit: cover;
            border-radius: 6px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: transform .18s, border-color .18s;
        }
        
        .fg-thumbs img.active {
            transform: scale(1.05);
            border-color: rgba(0, 0, 0, 0.2);
        }
        
        @media (max-width: 760px) {
            .fg-panel {
                padding: 14px;
            }
            .fg-thumbs img {
                width: 72px;
                height: 52px;
            }
        }
        /* ================================================
           ANIMATION OPTIONS
        ================================================= */
        
        .fg-zoom .fg-main-img {
            transform: scale(1.03);
        }
        
        .fg-blur .fg-main-img {
            filter: blur(2px) grayscale(.03);
        }
        
        .fg-fade .fg-main-img {
            opacity: 0;
            transition: opacity .45s ease;
        }
        
        .fg-fade.show .fg-main-img {
            opacity: 1;
        }
        /* ================================================
           VEHICLE VARIANT + SPECS TABLE
        ================================================= */
        
        .vd-price-box {
            margin-top: 8px;
            padding: 8px 10px;
            border-radius: 6px;
            background: #f5f5f5;
        }
        
        .vd-price {
            font-size: 1.25rem;
            font-weight: 800;
            color: #0040a5;
        }
        
        .vd-table {
            border: 1px solid #e1e1e1;
            border-radius: 8px;
            font-size: .9rem;
        }
        
        .vd-table-row {
            display: flex;
            justify-content: space-between;
            padding: 6px 10px;
            border-bottom: 1px solid #eee;
        }
        
        .vd-table-row:last-child {
            border-bottom: none;
        }
        
        .vd-table-label {
            font-weight: 600;
            margin-right: 12px;
        }
        
        @media (max-width: 768px) {
            .fg-info .row {
                flex-direction: column;
            }
        }
    </style>
</head>

<body style="background:#f8f9fa;">

    <!-- ================================================================
         GALLERY SECTION
    ================================================================= -->
    <section id="fancy-gallery" class="py-5">
        <div class="container">

            <div class="row align-items-center mb-4">
                <div class="col">
                    <h2 class="fw-bold mb-1">Stock</h2>
                    <p class="text-muted mb-0">Click any card to view stock's, description, models and specifications.</p>
                </div>

                <div class="col-auto">
                    <button id="fg-toggle-layout" class="btn btn-outline-secondary btn-sm">Switch to 3×</button>
                </div>
            </div>

            <div class="row" id="fg-grid">

                <!-- Card 0 -->
                <div class="col-6 col-md-4 col-lg-3 mb-4">
                    <div class="fg-card card h-100 border-0" data-group="0" tabindex="0">
                        <img src="img/Yuan_Up.png" class="img-fluid rounded" alt="">
                        <div class="mt-2">
                            <strong class="fg-title">Yuan Up</strong>
                            <small class="fg-sub text-muted">Range:401KM • From: 32,000,000 RWF</small>
                        </div>
                    </div>
                </div>

                <!-- Card 1 -->
                <div class="col-6 col-md-4 col-lg-3 mb-4">
                    <div class="fg-card card h-100 border-0" data-group="1" tabindex="0">
                        <img src="img/gallery/Yuan Plus/Yuan Plus4.webp" class="img-fluid rounded" alt="">
                        <div class="mt-2">
                            <strong class="fg-title">BYD Yuan Plus</strong>
                            <small class="fg-sub text-muted">Range:430–510KM • From: 36,000,000 RWF</small>
                        </div>
                    </div>
                </div>

                <!-- Card 2 -->
                <div class="col-6 col-md-4 col-lg-3 mb-4">
                    <div class="fg-card card h-100 border-0" data-group="2" tabindex="0">
                        <img src="img/gallery/BYD_Song_Plus_DM-i.jpg" class="img-fluid rounded" alt="">
                        <div class="mt-2">
                            <strong class="fg-title">BYD Song Plus</strong>
                            <small class="fg-sub text-muted">Range:430KM • From: 45,000,000 RWF</small>
                        </div>
                    </div>
                </div>

                <!-- Card 3 -->
                <div class="col-6 col-md-4 col-lg-3 mb-4">
                    <div class="fg-card card h-100 border-0" data-group="3" tabindex="0">
                        <img src="img/leopard3.png" class="img-fluid rounded" alt="">
                        <div class="mt-2">
                            <strong class="fg-title">BYD Leopard 3</strong>
                            <small class="fg-sub text-muted">Range:501KM • From: 56,000,000 RWF</small>
                        </div>
                    </div>
                </div>

                <!-- Card 4 -->
                <div class="col-6 col-md-4 col-lg-3 mb-4">
                    <div class="fg-card card h-100 border-0" data-group="4" tabindex="0">
                        <img src="img/GeelyStarWish.jpg" class="img-fluid rounded" alt="">
                        <div class="mt-2">
                            <strong class="fg-title">Geely Starwish</strong>
                            <small class="fg-sub text-muted">Range:310KM • From: 25,000,000 RWF</small>
                        </div>
                    </div>
                </div>

                <!-- Card 5 -->
                <div class="col-6 col-md-4 col-lg-3 mb-4">
                    <div class="fg-card card h-100 border-0" data-group="5" tabindex="0">
                        <img src="img/geelyEX5.png" class="img-fluid rounded" alt="">
                        <div class="mt-2">
                            <strong class="fg-title">Geely EX5</strong>
                            <small class="fg-sub text-muted">Range:490KM • From: 45,000,000 RWF</small>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <!-- ================================================================
         LIGHTBOX MODAL
    ================================================================= -->
    <div id="fg-lightbox" class="fg-lightbox d-none">
        <div class="fg-backdrop" data-close></div>

        <div class="fg-panel">

            <button class="fg-close btn btn-light btn-sm" aria-label="Close" data-close>✕</button>

            <div class="fg-main-wrap">
                <div class="fg-main-media">
                    <img id="fg-main-img" src="" class="fg-main-img" alt="">
                    <div class="fg-anim-overlay"></div>
                </div>

                <div class="fg-controls d-flex gap-2">
                    <button id="fg-prev" class="btn btn-outline-dark btn-sm">◀</button>
                    <button id="fg-play" class="btn btn-outline-primary btn-sm">Play</button>
                    <button id="fg-next" class="btn btn-outline-dark btn-sm">▶</button>
                </div>

                <div class="fg-thumbs mt-2" id="fg-thumbs"></div>

                <!-- INFO + VARIANTS + SPECS -->
                <div class="fg-info mt-3">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <h4 id="fg-title"></h4>
                            <p id="fg-desc" class="text-muted mb-1"></p>
                            <small id="fg-counter" class="text-muted d-block mb-2"></small>

                            <label for="variantSelect" class="form-label mb-1" style="font-size:.85rem;">Select model</label>
                            <select id="variantSelect" class="form-select form-select-sm mb-2"></select>

                            <div class="vd-price-box">
                                <span class="vd-price" id="variantPrice"></span>
                                <small class="text-muted d-block">Estimated retail price</small>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="vd-table" id="variantSpecs"></div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- ================================================================
         FULL JAVASCRIPT
    ================================================================= -->
    <script>
        (function() {

            /* ===========================
               IMAGE + SPEC DATA GROUPS
            ============================ */
            const fgGroups =

                [{


                    "title": "BYD Yuan Up",
                    "desc": "The BYD Yuan Up is a subcompact electric SUV designed for urban mobility. Built on BYD's e-platform 3.0, it features the company's renowned Blade Battery technology, offering safety, efficiency, and practicality in a compact package ideal for city driving.",
                    "variants": [{
                        "name": "Vitality (Low)",
                        "price": "32,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Subcompact SUV",
                            "Energy Type": "Fully Electric",
                            "Motor": "70 kW (95 HP) / 180 N·m",
                            "Battery": "45.12 kWh LFP Blade Battery",
                            "Range (km)": "401 (CLTC)",
                            "Charging": "30% → 80% in 30 min (DC fast)",
                            "Top Speed": "130 km/h",
                            "Seats": "5"
                        }
                    }, {
                        "name": "Comfort (Medium)",
                        "price": "34,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Subcompact SUV",
                            "Energy Type": "Fully Electric",
                            "Motor": "70 kW (95 HP) / 180 N·m",
                            "Battery": "50.1 kWh LFP Blade Battery",
                            "Range (km)": "430 (CLTC)",
                            "Charging": "30% → 80% in 30 min (DC fast)",
                            "Top Speed": "130 km/h",
                            "Seats": "5 + enhanced comfort features"
                        }
                    }, {
                        "name": "Premium (Full Option)",
                        "price": "38,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Subcompact SUV",
                            "Energy Type": "Fully Electric",
                            "Motor": "70 kW (95 HP) / 180 N·m",
                            "Battery": "55 kWh LFP Blade Battery",
                            "Range (km)": "460 (CLTC)",
                            "Charging": "30% → 80% in 30 min (DC fast)",
                            "Top Speed": "130 km/h",
                            "Seats": "5 + panoramic sunroof + advanced features"
                        }
                    }],
                    "images": [
                        "img/gallery/Yuan Up/Pink.png.webp",
                        "img/gallery/Yuan Up/Pink2.jpg.webp",
                        "img/gallery/Yuan Up/White3-1.png.webp",
                        "img/gallery/Yuan Up/White4.png.webp",
                        "img/gallery/Yuan Up/Yuan_Up_1.png",
                        "img/gallery/Yuan Up/Yuan_Up_interior.png",
                        "img/gallery/Yuan Up/yuan_Up_interior1.webp"
                    ]
                }, {
                    "title": "BYD Yuan Plus",
                    "desc": "The BYD Yuan Plus (also known as Atto 3 in some markets) is a compact electric SUV that combines practicality with advanced technology. Featuring BYD's Blade Battery and the DiLink intelligent connectivity system, it offers impressive range and modern features for families and tech-savvy drivers.",
                    "variants": [{
                        "name": "430KM Leading (Low)",
                        "price": "36,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Compact SUV",
                            "Energy Type": "Fully Electric",
                            "Motor": "150 kW (204 HP) / 310 N·m",
                            "Battery": "49.92 kWh LFP Blade Battery",
                            "Range (km)": "430 (CLTC)",
                            "Charging": "30% → 80% in 29 min (DC fast)",
                            "Top Speed": "160 km/h",
                            "Seats": "5"
                        }
                    }, {
                        "name": "510KM Leading (Medium)",
                        "price": "40,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Compact SUV",
                            "Energy Type": "Fully Electric",
                            "Motor": "150 kW (204 HP) / 310 N·m",
                            "Battery": "60.48 kWh LFP Blade Battery",
                            "Range (km)": "510 (CLTC)",
                            "Charging": "30% → 80% in 35 min (DC fast)",
                            "Top Speed": "160 km/h",
                            "Seats": "5 + enhanced interior"
                        }
                    }, {
                        "name": "510KM Excellence (Full Option)",
                        "price": "45,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Compact SUV",
                            "Energy Type": "Fully Electric",
                            "Motor": "150 kW (204 HP) / 310 N·m",
                            "Battery": "60.48 kWh LFP Blade Battery",
                            "Range (km)": "510 (CLTC)",
                            "Charging": "30% → 80% in 35 min (DC fast)",
                            "Top Speed": "160 km/h",
                            "Seats": "5 + premium leather + ADAS suite"
                        }
                    }],
                    "images": [
                        "img/gallery/Yuan Plus/Yuan Plus 3.webp",
                        "img/gallery/Yuan Plus/Yuan Plus2.webp",
                        "img/gallery/Yuan Plus/Yuan Plus4.webp",
                        "img/gallery/Yuan Plus/2ad6cc0521092791f326df230d3d44842508x0-2.webp",
                        "img/gallery/Yuan Plus/5f6bd0fa2b2f0d7eb670d511dae32bab2508x0.webp",
                        "img/gallery/Yuan Plus/327c2aec213bdce82f91f3fcddb22d3a2508x0.webp",
                        "img/gallery/Yuan Plus/39512ebff90b5c9e7541721792666b4f2508x0-2.webp"
                    ]
                }, {
                    "title": "BYD Song Plus",
                    "desc": "The BYD Song Plus DM-i is a mid-size SUV featuring BYD's advanced plug-in hybrid technology. With the DM-i super hybrid system, it delivers exceptional fuel efficiency, extended electric range, and seamless power delivery, making it perfect for families seeking versatility and economy.",
                    "variants": [{
                        "name": "Standard (Low)",
                        "price": "45,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Mid-size SUV",
                            "Energy Type": "Plug-in Hybrid (DM-i)",
                            "Motor": "1.5L Atkinson + 145 kW electric motor",
                            "Battery": "18.3 kWh LFP Blade Battery",
                            "Range (km)": "110 EV / 1200+ combined (NEDC)",
                            "Charging": "3.5 hours (AC 6.6 kW)",
                            "Top Speed": "175 km/h",
                            "Seats": "5"
                        }
                    }, {
                        "name": "Comfort (Medium)",
                        "price": "48,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Mid-size SUV",
                            "Energy Type": "Plug-in Hybrid (DM-i)",
                            "Motor": "1.5L Atkinson + 160 kW electric motor",
                            "Battery": "26.6 kWh LFP Blade Battery",
                            "Range (km)": "200 EV / 1200+ combined (NEDC)",
                            "Charging": "3-4 hours (AC 6.6 kW)",
                            "Top Speed": "180 km/h",
                            "Seats": "5 + upgraded comfort package"
                        }
                    }, {
                        "name": "Flagship (Full Option)",
                        "price": "52,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Mid-size SUV",
                            "Energy Type": "Plug-in Hybrid (DM-i)",
                            "Motor": "1.5L Atkinson + 160 kW electric motor",
                            "Battery": "26.6 kWh LFP Blade Battery",
                            "Range (km)": "200 EV / 1200+ combined (NEDC)",
                            "Charging": "3-4 hours (AC 6.6 kW)",
                            "Top Speed": "180 km/h",
                            "Seats": "5 + premium leather + full ADAS"
                        }
                    }],
                    "images": [
                        "img/gallery/2023_BYD_Song_Plus_DM-i_(front).jpg",
                        "img/gallery/BYD_song_plus_interior.jpg",
                        "img/gallery/BYD_Song_Plus_DM-i.jpg"
                    ]
                }, {
                    "title": "BYD Leopard 5",
                    "desc": "The BYD Leopard 5 (also known as Fangchengbao Leopard 5) is a rugged plug-in hybrid SUV built for serious off-road capability. Featuring a body-on-frame construction, advanced four-wheel drive system, and BYD's DMO super hybrid platform, it combines off-road prowess with modern efficiency.",
                    "variants": [{
                        "name": "Explorer (Low)",
                        "price": "56,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Off-road SUV",
                            "Energy Type": "Plug-in Hybrid (DMO)",
                            "Motor": "1.5T engine + dual motors (4WD)",
                            "Battery": "31.18 kWh LFP Blade Battery",
                            "Range (km)": "125 EV / 1200+ combined (CLTC)",
                            "Charging": "AC charging 3-4 hours",
                            "Top Speed": "160 km/h",
                            "Seats": "5"
                        }
                    }, {
                        "name": "Adventure (Medium)",
                        "price": "60,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Off-road SUV",
                            "Energy Type": "Plug-in Hybrid (DMO)",
                            "Motor": "1.5T engine + dual motors (4WD)",
                            "Battery": "31.18 kWh LFP Blade Battery",
                            "Range (km)": "125 EV / 1200+ combined (CLTC)",
                            "Charging": "AC + DC fast charging",
                            "Top Speed": "160 km/h",
                            "Seats": "5 + off-road enhancement package"
                        }
                    }, {
                        "name": "Warrior (Full Option)",
                        "price": "65,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Off-road SUV",
                            "Energy Type": "Plug-in Hybrid (DMO)",
                            "Motor": "1.5T engine + dual motors (4WD)",
                            "Battery": "31.18 kWh LFP Blade Battery",
                            "Range (km)": "125 EV / 1200+ combined (CLTC)",
                            "Charging": "AC + DC fast charging",
                            "Top Speed": "160 km/h",
                            "Seats": "5 + luxury interior + advanced off-road tech"
                        }
                    }],
                    "images": [
                        "img/gallery/leopard3.png.webp",
                        "img/gallery/bydLeopard3.jpeg"
                    ]
                }, {
                    "title": "Geely Galaxy Starship",
                    "desc": "The Geely Galaxy Starship (Xingyuan) is a mid-size sedan built on Geely's advanced CMA architecture, shared with Volvo. It emphasizes refined comfort, intelligent technology, and efficient powertrains, offering a premium driving experience with comprehensive safety features.",
                    "variants": [{
                        "name": "Standard (Low)",
                        "price": "25,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Mid-size Sedan",
                            "Energy Type": "Petrol",
                            "Motor": "1.5T turbocharged (181 HP)",
                            "Battery": "—",
                            "Range (km)": "—",
                            "Charging": "—",
                            "Top Speed": "205 km/h",
                            "Seats": "5"
                        }
                    }, {
                        "name": "Comfort (Medium)",
                        "price": "28,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Mid-size Sedan",
                            "Energy Type": "Mild Hybrid",
                            "Motor": "1.5T + 48V mild hybrid system",
                            "Battery": "48V lithium-ion",
                            "Range (km)": "—",
                            "Charging": "Regenerative braking",
                            "Top Speed": "205 km/h",
                            "Seats": "5 + enhanced comfort features"
                        }
                    }, {
                        "name": "Flagship (Full Option)",
                        "price": "32,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Mid-size Sedan",
                            "Energy Type": "Plug-in Hybrid",
                            "Motor": "1.5T + electric motor (combined 258 HP)",
                            "Battery": "18.3 kWh lithium-ion",
                            "Range (km)": "100 EV / 1200+ combined (NEDC)",
                            "Charging": "AC charging 2-3 hours",
                            "Top Speed": "210 km/h",
                            "Seats": "5 + premium leather + full tech suite"
                        }
                    }],
                    "images": [
                        "img/gallery/Geely-Star-Wish-2025-appearance-3.webp",
                        "img/gallery/Geely-Star-Wish-2025-interior-1.webp",
                        "img/gallery/GeelyStarWish.png"
                    ]
                }, {
                    "title": "Geely Galaxy E5",
                    "desc": "The Geely Galaxy E5 is a fully electric compact SUV offering spacious interior design, advanced driver assistance systems, and impressive range. Built on Geely's SEA pure electric architecture, it delivers quiet operation, strong performance, and comprehensive connectivity features.",
                    "variants": [{
                        "name": "Standard (Low)",
                        "price": "45,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Compact SUV",
                            "Energy Type": "Fully Electric",
                            "Motor": "160 kW (218 HP) / 320 N·m",
                            "Battery": "49.52 kWh NCM battery",
                            "Range (km)": "440 (CLTC)",
                            "Charging": "30% → 80% in 27 min (DC fast)",
                            "Top Speed": "170 km/h",
                            "Seats": "5"
                        }
                    }, {
                        "name": "Long Range (Medium)",
                        "price": "48,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Compact SUV",
                            "Energy Type": "Fully Electric",
                            "Motor": "160 kW (218 HP) / 320 N·m",
                            "Battery": "60.22 kWh NCM battery",
                            "Range (km)": "530 (CLTC)",
                            "Charging": "30% → 80% in 28 min (DC fast)",
                            "Top Speed": "170 km/h",
                            "Seats": "5 + comfort package"
                        }
                    }, {
                        "name": "Premium (Full Option)",
                        "price": "52,000,000 RWF",
                        "specs": {
                            "Vehicle Type": "Compact SUV",
                            "Energy Type": "Fully Electric",
                            "Motor": "160 kW (218 HP) / 320 N·m",
                            "Battery": "60.22 kWh NCM battery",
                            "Range (km)": "530 (CLTC)",
                            "Charging": "30% → 80% in 28 min (DC fast)",
                            "Top Speed": "170 km/h",
                            "Seats": "5 + premium interior + full ADAS"
                        }
                    }],
                    "images": [
                        "img/gallery/Geely_Ex5.jpeg",
                        "img/gallery/Geely_EX5_Interior2.jpg",
                        "img/gallery/Geely_Ex5 copy.jpeg"
                    ]
                }];

            /* ===========================
               ELEMENT REFERENCES
            ============================ */
            const cards = document.querySelectorAll('.fg-card');
            const lb = document.getElementById('fg-lightbox');
            const lbBackdrop = lb.querySelector('.fg-backdrop');
            const lbMainImg = document.getElementById('fg-main-img');
            const lbTitle = document.getElementById('fg-title');
            const lbDesc = document.getElementById('fg-desc');
            const lbCounter = document.getElementById('fg-counter');
            const lbThumbs = document.getElementById('fg-thumbs');
            const btnCloseAll = document.querySelectorAll('[data-close]');
            const btnPrev = document.getElementById('fg-prev');
            const btnNext = document.getElementById('fg-next');
            const btnPlay = document.getElementById('fg-play');
            const toggleLayoutBtn = document.getElementById('fg-toggle-layout');

            const variantSelect = document.getElementById('variantSelect');
            const variantSpecs = document.getElementById('variantSpecs');
            const variantPrice = document.getElementById('variantPrice');

            let activeGroup = null;
            let activeIndex = 0;
            let autoplay = false;
            let autoplayTimer = null;

            let animMode = 'fg-zoom'; // fg-zoom, fg-blur, fg-fade

            /* ===========================
               OPEN LIGHTBOX
            ============================ */
            cards.forEach(card => {
                card.addEventListener('click', () => {
                    openLightbox(parseInt(card.dataset.group), 0);
                });

                card.addEventListener('keydown', e => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        openLightbox(parseInt(card.dataset.group), 0);
                    }
                });
            });

            function openLightbox(groupIndex, imgIndex) {
                activeGroup = groupIndex;
                activeIndex = imgIndex;

                const group = fgGroups[groupIndex];
                if (!group) return;

                lbTitle.textContent = group.title;
                lbDesc.innerHTML = group.desc.replace(/\n/g, '<br>');
                lb.classList.remove('fg-zoom', 'fg-blur', 'fg-fade', 'show');
                lb.classList.add(animMode);

                buildThumbs();
                renderMain();
                loadVariants(group);

                lb.classList.remove('d-none');
                lb.setAttribute('aria-hidden', 'false');

                if (animMode === 'fg-fade') {
                    requestAnimationFrame(() => lb.classList.add('show'));
                }

                prefetchNext();
            }

            /* ===========================
               CLOSE LIGHTBOX
            ============================ */
            btnCloseAll.forEach(btn => btn.addEventListener('click', closeLightbox));
            lbBackdrop.addEventListener('click', closeLightbox);

            function closeLightbox() {
                lb.classList.add('d-none');
                lb.setAttribute('aria-hidden', 'true');
                stopAutoplay();
            }

            /* ===========================
               MAIN IMAGE RENDER
            ============================ */
            function renderMain() {
                const imgs = fgGroups[activeGroup].images;
                lbMainImg.src = imgs[activeIndex];
                lbMainImg.alt = fgGroups[activeGroup].title + ' — ' + (activeIndex + 1);
                lbCounter.textContent = `${activeIndex + 1} / ${imgs.length}`;

                [...lbThumbs.children].forEach((el, i) =>
                    el.classList.toggle('active', i === activeIndex)
                );
            }

            /* ===========================
               BUILD THUMBNAILS
            ============================ */
            function buildThumbs() {
                lbThumbs.innerHTML = '';
                fgGroups[activeGroup].images.forEach((src, i) => {
                    const im = document.createElement('img');
                    im.src = src;
                    im.alt = "Thumbnail " + (i + 1);
                    im.addEventListener('click', () => {
                        activeIndex = i;
                        renderMain();
                        prefetchNext();
                    });
                    lbThumbs.appendChild(im);
                });
                renderMain();
            }

            /* ===========================
               VARIANTS + SPECS
            ============================ */
            function loadVariants(group) {
                variantSelect.innerHTML = '';
                (group.variants || []).forEach((variant, idx) => {
                    const opt = document.createElement('option');
                    opt.value = idx;
                    opt.textContent = variant.name;
                    variantSelect.appendChild(opt);
                });

                variantSelect.onchange = () => {
                    showVariant(group, parseInt(variantSelect.value, 10) || 0);
                };

                showVariant(group, 0);
            }

            function showVariant(group, idx) {
                const variants = group.variants || [];
                const variant = variants[idx] || variants[0];
                if (!variant) {
                    variantSpecs.innerHTML = '';
                    variantPrice.textContent = '';
                    return;
                }

                variantPrice.textContent = variant.price || '';

                variantSpecs.innerHTML = '';
                const specs = variant.specs || {};
                Object.keys(specs).forEach(key => {
                    const row = document.createElement('div');
                    row.className = 'vd-table-row';
                    row.innerHTML =
                        `<span class="vd-table-label">${key}</span><span class="vd-table-value">${specs[key]}</span>`;
                    variantSpecs.appendChild(row);
                });
            }

            /* ===========================
               CONTROLS
            ============================ */
            btnPrev.addEventListener('click', prevImage);
            btnNext.addEventListener('click', nextImage);

            function prevImage() {
                const len = fgGroups[activeGroup].images.length;
                activeIndex = (activeIndex - 1 + len) % len;
                renderMain();
                prefetchNext();
            }

            function nextImage() {
                const len = fgGroups[activeGroup].images.length;
                activeIndex = (activeIndex + 1) % len;
                renderMain();
                prefetchNext();
            }

            /* ===========================
               KEYBOARD SUPPORT
            ============================ */
            document.addEventListener('keydown', e => {
                if (lb.classList.contains('d-none')) return;
                if (e.key === 'Escape') closeLightbox();
                if (e.key === 'ArrowLeft') prevImage();
                if (e.key === 'ArrowRight') nextImage();
            });

            /* ===========================
               AUTOPLAY
            ============================ */
            btnPlay.addEventListener('click', () => {
                autoplay ? stopAutoplay() : startAutoplay(3000);
            });

            function startAutoplay(interval) {
                autoplay = true;
                btnPlay.textContent = 'Pause';
                autoplayTimer = setInterval(nextImage, interval);
            }

            function stopAutoplay() {
                autoplay = false;
                btnPlay.textContent = 'Play';
                clearInterval(autoplayTimer);
            }

            /* ===========================
               PREFETCH NEXT IMAGE
            ============================ */
            function prefetchNext() {
                const imgs = fgGroups[activeGroup].images;
                const next = imgs[(activeIndex + 1) % imgs.length];
                const l = document.createElement('link');
                l.rel = 'prefetch';
                l.href = next;
                document.head.appendChild(l);
            }

            /* ===========================
               LAYOUT SWITCHER (4× <-> 3×)
            ============================ */
            let is4col = true;

            toggleLayoutBtn.addEventListener('click', () => {
                const grid = document.getElementById('fg-grid');
                is4col = !is4col;

                [...grid.children].forEach(col => {
                    col.classList.toggle('col-lg-3', is4col);
                    col.classList.toggle('col-lg-4', !is4col);
                });

                toggleLayoutBtn.textContent = is4col ? 'Switch to 3×' : 'Switch to 4×';
            });

            /* ===========================
               PREVENT BACKGROUND SCROLL
            ============================ */
            const observer = new MutationObserver(() => {
                if (!lb.classList.contains('d-none')) {
                    document.documentElement.style.overflow = 'hidden';
                    document.body.style.overflow = 'hidden';
                } else {
                    document.documentElement.style.overflow = '';
                    document.body.style.overflow = '';
                }
            });
            observer.observe(lb, {
                attributes: true,
                attributeFilter: ['class']
            });

            stopAutoplay();

        })();
    </script>

</body>

</html>
